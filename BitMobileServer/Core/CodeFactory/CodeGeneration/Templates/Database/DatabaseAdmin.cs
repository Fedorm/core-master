// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 11.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace CodeFactory.CodeGeneration.Templates.Database
{
    using System.Linq;
    using System.Text;
    using System.Collections.Generic;
    using System;
    
    /// <summary>
    /// Class to produce the template output
    /// </summary>
    
    #line 1 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "11.0.0.0")]
    public partial class DatabaseAdmin : DatabaseAdminBase
    {
#line hidden
        /// <summary>
        /// Create the template output
        /// </summary>
        public virtual string TransformText()
        {
            this.Write("\r\nCREATE TABLE [admin].DeviceLog(\r\n\t[StartTime] DATETIME NOT NULL,\r\n\t[EndTime] DA" +
                    "TETIME NOT NULL,\r\n\t[FirstSync] BIT NOT NULL,\r\n\t[Direction] INT NOT NULL,\r\n\t[Devi" +
                    "ceId] VARCHAR(150) NOT NULL,\r\n\t[Login] VARCHAR(50) NOT NULL,\r\n\t[UserId] UNIQUEID" +
                    "ENTIFIER NULL,\r\n\t[UserEMail] VARCHAR(100) NULL,\r\n\t[ContentLength] INT NOT NULL,\r" +
                    "\n\t[ContentType] VARCHAR(100) NOT NULL,\r\n\t[Accept] VARCHAR(100) NULL,\r\n\t[AcceptEn" +
                    "coding] VARCHAR(100) NULL,\r\n\t[Host] VARCHAR(250) NULL,\r\n\t[ConfigName] VARCHAR(25" +
                    "0) NOT NULL,\r\n\t[ConfigVersion] VARCHAR(50) NOT NULL,\r\n\t[CoreVersion] VARCHAR(50)" +
                    " NOT NULL,\r\n\t[ResourceVersion] VARCHAR(50) NULL,\r\n\t[OutputContentLength] INT NOT" +
                    " NULL,\r\n\t[StatusCode] INT NOT NULL,\t\t\t\r\n\t[StatusDescription] VARCHAR(MAX) NULL\t\t" +
                    "\t\r\n)\r\nGO\r\nALTER TABLE [admin].DeviceLog ADD CONSTRAINT UQ_DeviceLog UNIQUE([Star" +
                    "tTime],[Login],[DeviceId])\r\nGO\r\n\r\nCREATE PROCEDURE [admin].WriteLog \r\n\t@StartTim" +
                    "e DATETIME,\r\n\t@EndTime DATETIME,\r\n\t@FirstSync BIT,\r\n\t@Direction INT,\r\n\t@DeviceId" +
                    " VARCHAR(150),\r\n\t@Login VARCHAR(50),\r\n\t@UserId UNIQUEIDENTIFIER,\r\n\t@UserEMail VA" +
                    "RCHAR(100),\r\n\t@ContentLength INT,\r\n\t@ContentType VARCHAR(100),\r\n\t@Accept VARCHAR" +
                    "(100),\r\n\t@AcceptEncoding VARCHAR(100),\r\n\t@Host VARCHAR(250),\r\n\t@ConfigName VARCH" +
                    "AR(250),\r\n\t@ConfigVersion VARCHAR(50),\r\n\t@CoreVersion VARCHAR(50),\r\n\t@ResourceVe" +
                    "rsion VARCHAR(50),\r\n\t@OutputContentLength INT,\r\n\t@StatusCode INT,\t\t\t\r\n\t@StatusDe" +
                    "scription VARCHAR(MAX)\t\r\nAS\r\nSET NOCOUNT ON\r\nINSERT INTO [admin].DeviceLog(\r\n\t[S" +
                    "tartTime],\r\n\t[EndTime],\r\n\t[FirstSync],\r\n\t[Direction],\r\n\t[DeviceId],\r\n\t[Login],\r\n" +
                    "\t[UserId],\r\n\t[UserEMail],\r\n\t[ContentLength],\r\n\t[ContentType],\r\n\t[Accept],\r\n\t[Acc" +
                    "eptEncoding],\r\n\t[Host],\r\n\t[ConfigName],\r\n\t[ConfigVersion],\r\n\t[CoreVersion],\r\n\t[R" +
                    "esourceVersion],\r\n\t[OutputContentLength],\r\n\t[StatusCode],\t\t\t\r\n\t[StatusDescriptio" +
                    "n]\r\n)\r\nVALUES(\r\n\t@StartTime,\r\n\t@EndTime,\r\n\t@FirstSync,\r\n\t@Direction,\r\n\t@DeviceId" +
                    ",\r\n\t@Login,\r\n\t@UserId,\r\n\t@UserEMail,\r\n\t@ContentLength,\r\n\t@ContentType,\r\n\t@Accept" +
                    ",\r\n\t@AcceptEncoding,\r\n\t@Host,\r\n\t@ConfigName,\r\n\t@ConfigVersion,\r\n\t@CoreVersion,\r\n" +
                    "\t@ResourceVersion,\r\n\t@OutputContentLength,\r\n\t@StatusCode,\t\t\t\r\n\t@StatusDescriptio" +
                    "n\t\r\n)\t\r\nGO\r\n\r\nCREATE TABLE [admin].AsyncUploadSession(\r\n\t[Id] UNIQUEIDENTIFIER P" +
                    "RIMARY KEY NONCLUSTERED,\r\n\t[StartTime] DATETIME NOT NULL,\r\n\t[EndTime] DATETIME N" +
                    "ULL,\r\n\t[Status] VARCHAR(MAX) NULL\r\n)\r\nGO\r\n\r\nCREATE TABLE [admin].FileSystem(\r\n\t[" +
                    "Date] DATETIME PRIMARY KEY NONCLUSTERED,\r\n\t[Data] VARBINARY(MAX) NOT NULL,\r\n\t[CR" +
                    "C] VARCHAR(20) NOT NULL\r\n)\r\nGO\r\n\r\nCREATE TABLE [admin].LastSyncTime(\r\n\tLastTime " +
                    "DATETIME NOT NULL PRIMARY KEY NONCLUSTERED\r\n)\r\nGO\r\n\r\nCREATE TABLE [admin].SyncSe" +
                    "ssion(\r\n\t[Id] UNIQUEIDENTIFIER PRIMARY KEY NONCLUSTERED,\r\n\tStartTime DATETIME NO" +
                    "T NULL,\r\n\tEndTime DATETIME NULL\r\n)\r\nGO\r\n\r\nCREATE TABLE [admin].DeletedObjects(\r\n" +
                    "\t[Id] UNIQUEIDENTIFIER PRIMARY KEY NONCLUSTERED,\r\n\t[Entity] VARCHAR(250) NOT NUL" +
                    "L,\r\n\t[CreationDate] DATETIME NOT NULL,\r\n\t[DeletionDate] DATETIME NULL\r\n)\r\nGO\r\n\r\n" +
                    "------------------------------------------------------------ Telegram ----------" +
                    "--------------------------------------------\r\n\r\n\r\nCREATE TABLE [admin].Telegram(" +
                    "\t\r\n\t[Phone] VARCHAR(20) PRIMARY KEY NONCLUSTERED,\r\n\t[AuthKey] VARCHAR(4000) NOT " +
                    "NULL,\r\n\t[ServerSalt] BIGINT NULL\r\n)\r\nGO\r\n\r\nCREATE PROCEDURE [admin].SaveTelegram" +
                    "Settings @Phone VARCHAR(20), @AuthKey VARCHAR(4000), @ServerSalt BIGINT AS\r\n\tSET" +
                    " NOCOUNT ON\r\n\t\r\n\tIF EXISTS (SELECT * FROM [admin].Telegram WHERE [Phone] = @Phon" +
                    "e)\r\n\t\tUPDATE [admin].Telegram SET AuthKey = @AuthKey, ServerSalt = @ServerSalt W" +
                    "HERE Phone = @Phone\r\n\tELSE\r\n\t\tINSERT INTO [admin].Telegram(Phone, AuthKey, Serve" +
                    "rSalt) VALUES(@Phone, @AuthKey, @ServerSalt)\r\nGO\r\n\r\n----------------------------" +
                    "-------------------------------- WebDav Log ------------------------------------" +
                    "----------------\r\nCREATE TABLE [admin].[DeviceLogWebDAV](\r\n\t[UserId] UNIQUEIDENT" +
                    "IFIER NOT NULL,\r\n\t[DeviceId] VARCHAR(250) NOT NULL,\r\n\t[StartTime] DATETIME NOT N" +
                    "ULL,\r\n\t[EndTime] DATETIME NOT NULL,\r\n\t[State] BIT NOT NULL,\r\n\t[Error] VARCHAR(MA" +
                    "X),\r\n\t[Directory] VARCHAR(250),\r\n\t[LoadedSize] INT NOT NULL,\r\n\t[LoadedCount] SMA" +
                    "LLINT NOT NULL,\r\n\t[DeletedSize] INT NOT NULL,\r\n\t[DeletedCount] SMALLINT NOT NULL" +
                    ",\r\n\t[ResourceVersion] VARCHAR(50) NOT NULL,\r\n\t[CoreVersion] VARCHAR(50) NOT NULL" +
                    ",\r\n\t[ConfigName] VARCHAR(250) NOT NULL,\r\n\t[ConfigVersion] VARCHAR(50) NOT NULL\r\n" +
                    ")\r\nGO\r\nALTER TABLE [admin].[DeviceLogWebDAV] ADD CONSTRAINT UQ_DeviceLogWebDAV U" +
                    "NIQUE([UserId], [DeviceId], [StartTime])\r\nGO\r\nCREATE PROCEDURE [admin].[WriteWeb" +
                    "DavLog]\r\n\t\t@UserId UNIQUEIDENTIFIER,\r\n\t\t@DeviceId VARCHAR(250),\r\n\t\t@StartTime DA" +
                    "TETIME,\r\n\t\t@EndTime DATETIME,\r\n\t\t@State BIT,\r\n\t\t@Error VARCHAR(MAX),\r\n\t\t@Directo" +
                    "ry VARCHAR(250),\r\n\t\t@LoadedSize INT,\r\n\t\t@LoadedCount SMALLINT,\r\n\t\t@DeletedSize I" +
                    "NT,\r\n\t\t@DeletedCount SMALLINT,\r\n\t\t@ResourceVersion VARCHAR(50),\r\n\t\t@CoreVersion " +
                    "VARCHAR(50),\r\n\t\t@ConfigName VARCHAR(250),\r\n\t\t@ConfigVersion VARCHAR(50)\r\nAS\r\nSET" +
                    " NOCOUNT ON\r\nINSERT INTO [admin].[DeviceLogWebDAV]\r\n           ([UserId]\r\n      " +
                    "     ,[DeviceId]\r\n           ,[StartTime]\r\n           ,[EndTime]\r\n           ,[S" +
                    "tate]\r\n           ,[Error]\r\n           ,[Directory]\r\n\t\t   ,[LoadedSize]\r\n       " +
                    "    ,[LoadedCount]\r\n           ,[DeletedSize]\r\n           ,[DeletedCount]\r\n     " +
                    "      ,[ResourceVersion]\r\n           ,[CoreVersion]\r\n           ,[ConfigName]\r\n " +
                    "          ,[ConfigVersion])\r\n     VALUES\r\n           (@UserId\r\n           ,@Devi" +
                    "ceId\r\n           ,@StartTime\r\n           ,@EndTime\r\n           ,@State\r\n        " +
                    "   ,@Error\r\n           ,@Directory\r\n\t\t   ,@LoadedSize\r\n           ,@LoadedCount " +
                    "    \r\n           ,@DeletedSize\r\n           ,@DeletedCount\r\n           ,@Resource" +
                    "Version\r\n           ,@CoreVersion\r\n           ,@ConfigName\r\n           ,@ConfigV" +
                    "ersion)\r\nGO\r\n\r\n------------------------------------------------------------ Sess" +
                    "ions ------------------------------------------------------\r\n\r\nCREATE PROCEDURE " +
                    "[admin].BeginAsyncUploadSession @SessionId UNIQUEIDENTIFIER AS\r\n\tSET NOCOUNT ON\r" +
                    "\n\tDECLARE @D DATETIME\r\n\tSET @D = GETDATE()\r\n\tINSERT INTO [admin].AsyncUploadSess" +
                    "ion([Id], [StartTime], [EndTime], [Status]) VALUES(@SessionId,@D,NULL,NULL)\r\nGO\r" +
                    "\n\r\nCREATE PROCEDURE [admin].CommitAsyncUploadSession @SessionId UNIQUEIDENTIFIER" +
                    ", @Status VARCHAR(MAX) AS\r\n\tSET NOCOUNT ON\r\n\tUPDATE [admin].AsyncUploadSession S" +
                    "ET [EndTime] = GETDATE(), [Status] = @Status WHERE [Id] = @SessionId\r\nGO\r\n\r\nCREA" +
                    "TE PROCEDURE [admin].CheckAsyncUploadSession @SessionId UNIQUEIDENTIFIER AS\r\n\tSE" +
                    "T NOCOUNT ON\r\n\tSELECT ISNULL([Status],\'\') FROM [admin].AsyncUploadSession WHERE " +
                    "[Id] = @SessionId\r\nGO\r\n\r\nCREATE PROCEDURE [admin].BeginSyncSession @SessionId UN" +
                    "IQUEIDENTIFIER AS\r\n\tSET NOCOUNT ON\r\n\tDECLARE @D DATETIME\r\n\tSET @D = GETDATE()\r\n\t" +
                    "INSERT INTO [admin].SyncSession([Id], [StartTime], [EndTime]) VALUES(@SessionId," +
                    "@D,NULL)\r\nGO\r\n\r\nCREATE PROCEDURE [admin].CommitSyncSession @SessionId UNIQUEIDEN" +
                    "TIFIER AS\r\n\tSET NOCOUNT ON\r\n\tDECLARE @D DATETIME\r\n\tSELECT @D = StartTime FROM [a" +
                    "dmin].SyncSession WHERE [Id] = @SessionId\r\n\tIF @D IS NULL\r\n\t  RAISERROR(\'Session" +
                    " is not found\', 16, 1)\r\n\tELSE\r\n\tBEGIN\r\n\t\tUPDATE [admin].LastSyncTime SET LastTim" +
                    "e = @D\r\n\t\tUPDATE [admin].SyncSession SET EndTime = GETDATE() WHERE [Id] = @Sessi" +
                    "onId\r\n\tEND\r\nGO\r\n\r\nCREATE PROCEDURE [admin].GetDeleted AS\r\n\tSET NOCOUNT ON\r\n\r\n\tSE" +
                    "LECT \r\n\t1 AS Tag, \r\n\tNULL AS Parent,\r\n\t\'\' AS [Root!1],\r\n\tNULL AS [Entity!2!Name]" +
                    ",\r\n\tNULL AS [Row!3!Id]\r\n\r\n\tUNION ALL\r\n\r\n\tSELECT \r\n\t\t2 AS Tag, \r\n\t\t1 AS Parent,\r\n" +
                    "\t\tNULL AS [Root!1],\r\n\t\tT.[Name] AS [Entity!2!Name],\r\n\t\tNULL AS [Row!3!Id]\r\n\tFROM" +
                    "\r\n\t(\r\n\t\tSELECT DISTINCT [Entity] AS [Name]\r\n\t\tFROM [admin].[DeletedObjects] WHER" +
                    "E [DeletionDate] IS NULL\r\n\t) T\r\n\r\n\tUNION ALL\r\n\r\n\tSELECT \r\n\t\t3 AS Tag, \r\n\t\t2 AS P" +
                    "arent,\r\n\t\tNULL AS [Root!1],\r\n\t\tT.[Name] AS [Entity!2!Name],\r\n\t\tT.[Id] AS [Row!3!" +
                    "Id]\r\n\tFROM\r\n\t(\r\n\t\tSELECT [Entity] AS [Name], [Id]\r\n\t\tFROM [admin].[DeletedObject" +
                    "s] WHERE [DeletionDate] IS NULL\r\n\t) T\r\n\r\n\tORDER BY 4,2,1\r\n\r\n\tFOR XML EXPLICIT\r\nG" +
                    "O\r\n\r\nCREATE PROCEDURE [admin].[GetDeviceLog] AS\r\n\tSET NOCOUNT ON\r\n\r\n\tSELECT \r\n\t1" +
                    " AS Tag, \r\n\tNULL AS Parent,\r\n\t\'\' AS [Root!1],\r\n\tNULL AS [Row!2!StartTime],\r\n\tNUL" +
                    "L AS [Row!2!EndTime],\r\n\tNULL AS [Row!2!FirstSync],\r\n\tNULL AS [Row!2!Direction],\r" +
                    "\n\tNULL AS [Row!2!DeviceId],\r\n\tNULL AS [Row!2!Login],\r\n\tNULL AS [Row!2!UserId],\r\n" +
                    "\tNULL AS [Row!2!UserEMail],\r\n\tNULL AS [Row!2!ContentLength],\r\n\tNULL AS [Row!2!Ou" +
                    "tputContentLength],\r\n\tNULL AS [Row!2!ConfigName],\r\n\tNULL AS [Row!2!ConfigVersion" +
                    "],\r\n\tNULL AS [Row!2!CoreVersion],\r\n\tNULL AS [Row!2!ResourceVersion],\r\n\tNULL AS [" +
                    "Row!2!StatusCode],\r\n\tNULL AS [Row!2!StatusDescription]\r\n\r\n\tUNION ALL\r\n\r\n\tSELECT " +
                    "\r\n\t\t2 AS Tag, \r\n\t\t1 AS Parent,\r\n\t\tNULL AS [Root!1],\r\n\t\t[StartTime] AS [Row!2!Sta" +
                    "rtTime],\r\n\t\t[EndTime] AS [Row!2!EndTime],\r\n\t\t[FirstSync] AS [Row!2!FirstSync],\r\n" +
                    "\t\t[Direction] AS [Row!2!Direction],\r\n\t\t[DeviceId] AS [Row!2!DeviceId],\r\n\t\t[Login" +
                    "] AS [Row!2!Login],\r\n\t\t[UserId] AS [Row!2!UserId],\r\n\t\t[UserEMail] AS [Row!2!User" +
                    "EMail],\r\n\t\t[ContentLength] AS [Row!2!ContentLength],\r\n\t\t[OutputContentLength] AS" +
                    " [Row!2!OutputContentLength],\r\n\t\t[ConfigName] AS [Row!2!ConfigName],\r\n\t\t[ConfigV" +
                    "ersion] AS [Row!2!ConfigVersion],\r\n\t\t[CoreVersion] AS [Row!2!CoreVersion],\r\n\t\t[R" +
                    "esourceVersion] AS [Row!2!ResourceVersion],\r\n\t\t[StatusCode] AS [Row!2!StatusCode" +
                    "],\r\n\t\t[StatusDescription] AS [Row!2!StatusDescription]\r\n\tFROM [admin].DeviceLog\r" +
                    "\n\r\n\tORDER BY 4,2,1\r\n\r\n\tFOR XML EXPLICIT\r\nGO\r\n\r\nCREATE PROCEDURE [admin].Logon @U" +
                    "serName VARCHAR(100), @UserPassword VARCHAR(100), @ConfigName VARCHAR(100), @Con" +
                    "figVersion VARCHAR(100) AS\r\n\tSET NOCOUNT ON\r\n\tDECLARE @SConfigName VARCHAR(100)," +
                    " @SConfigVersion VARCHAR(100), @SConfigVersionMasked VARCHAR(100)\r\n\tSET @SConfig" +
                    "Name = \'");
            
            #line 367 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(config.ConfigVersion.Name));
            
            #line default
            #line hidden
            this.Write("\'\r\n\tSET @SConfigVersion = \'");
            
            #line 368 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(config.ConfigVersion.Version));
            
            #line default
            #line hidden
            this.Write("\'\r\n\tSET @SConfigVersionMasked = \'");
            
            #line 369 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(config.ConfigVersion.VersionMasked));
            
            #line default
            #line hidden
            this.Write("\'\r\n\r\n\tIF @SConfigName <> @ConfigName OR NOT @ConfigVersion LIKE @SConfigVersionMa" +
                    "sked\r\n\t\tRAISERROR(\'Invalid client version. The server configuration is \"%s ver.%" +
                    "s\"\', 16, 1, @SConfigName, @SConfigVersion)\r\n\tELSE\r\n\t\tSELECT TOP 1 Id,EMail FROM " +
                    "[Catalog].[User] WHERE UserName=@UserName AND Password=@UserPassword AND Role=\'S" +
                    "R\'\r\nGO\r\n\r\nCREATE PROCEDURE [admin].CheckUser @UserId UNIQUEIDENTIFIER, @UserPass" +
                    "word VARCHAR(100) AS\r\n\tSET NOCOUNT ON\r\n\tSELECT TOP 1 Id FROM [Catalog].[User] WH" +
                    "ERE [Id]=@UserId AND Password=@UserPassword\r\nGO\r\n\r\nALTER TABLE [Catalog].[User] " +
                    "ADD CONSTRAINT UQ_Catalog_User_UserName UNIQUE([UserName])\r\nGO\r\n\r\n--------------" +
                    "---------------------------------------------- Push ----------------------------" +
                    "------------------------------\r\n\r\nCREATE TABLE [admin].UserPushTokens(\r\n\t[UserId" +
                    "] UNIQUEIDENTIFIER NOT NULL,\r\n\t[DeviceId] VARCHAR(250) NOT NULL,\r\n\t[OS] VARCHAR(" +
                    "10) NOT NULL,\r\n\t[Package] VARCHAR(250) NOT NULL,\r\n\t[Token] VARCHAR(250) NOT NULL" +
                    "\r\n)\r\nGO\r\n\r\nALTER TABLE [admin].UserPushTokens ADD CONSTRAINT UQ_UserPushTokens U" +
                    "NIQUE([UserId],[DeviceId],[Token])\r\nGO\r\n\r\nCREATE PROCEDURE [admin].[GetUserPushT" +
                    "okens] @UserId UNIQUEIDENTIFIER\r\nAS\r\nSELECT [Token], [OS] FROM [admin].UserPushT" +
                    "okens WHERE [UserId] = @UserId\r\nGO\r\n\r\nCREATE PROCEDURE [admin].[RegisterPushToke" +
                    "n] @UserId UNIQUEIDENTIFIER, @DeviceId VARCHAR(250), @OS VARCHAR(10), @Package V" +
                    "ARCHAR(250), @Token VARCHAR(250)\r\nAS\r\nIF NOT EXISTS(SELECT * FROM [admin].[UserP" +
                    "ushTokens] WHERE [UserId] = @UserId AND [DeviceId] = @DeviceId AND [OS] = @OS AN" +
                    "D [Package] = @Package)\r\n\tINSERT INTO [admin].UserPushTokens([UserId],[DeviceId]" +
                    ",[OS],[Package],[Token]) VALUES(@UserId, @DeviceId, @OS, @Package, @Token)\r\nELSE" +
                    "\r\n\tUPDATE [admin].UserPushTokens SET [Token] = @Token WHERE [UserId] = @UserId A" +
                    "ND [DeviceId] = @DeviceId AND [OS] = @OS AND [Package] = @Package\r\nGO\r\n\r\n-------" +
                    "----------------------------------------------------- GPS ----------------------" +
                    "------------------------------------\r\n\r\nCREATE TABLE [admin].GPS(\r\n\t[UserId] UNI" +
                    "QUEIDENTIFIER NOT NULL,\r\n\t[ServerTime] DATETIME NOT NULL,\r\n\t[BeginTime] DATETIME" +
                    " NOT NULL,\r\n\t[EndTime] DATETIME NOT NULL,\r\n\t[Latitude] DECIMAL(12,9) NOT NULL,\r\n" +
                    "\t[Longitude] DECIMAL(12,9) NOT NULL,\r\n\t[Speed] DECIMAL(6,2),\r\n\t[Direction] INT, " +
                    "\r\n\t[SatellitesCount] INT,\r\n\t[Altitude] DECIMAL(12,9)\r\n)\r\nGO\r\n\r\nALTER TABLE [admi" +
                    "n].GPS ADD CONSTRAINT FK_ADMIN_GPS_CATALOG_USER FOREIGN KEY([UserId]) REFERENCES" +
                    " [Catalog].[User]([Id])\r\nGO\r\n\r\n-------------------------------------------------" +
                    "--------CRUD OPERATIONS --------------------------------------------------------" +
                    "--\r\nGO\r\n\r\n");
            
            #line 434 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var entity in config.Entities){ 
            
            #line default
            #line hidden
            this.Write("\r\nCREATE PROCEDURE [");
            
            #line 436 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 436 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_adm_insert]\r\n\t");
            
            #line 437 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t@");
            
            #line 438 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 438 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.SqlTypeShort));
            
            #line default
            #line hidden
            
            #line 438 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 438 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 439 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("AS\r\n\tSET NOCOUNT ON\r\n\tINSERT INTO [");
            
            #line 442 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 442 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("](\r\n\t\t");
            
            #line 443 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t\t[");
            
            #line 444 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 444 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 444 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 445 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t) \r\n\tVALUES\r\n\t(\r\n\t\t");
            
            #line 449 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t\t@");
            
            #line 450 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            
            #line 450 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 450 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 451 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t)\r\nGO\r\n\r\nCREATE PROCEDURE [");
            
            #line 455 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 455 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_adm_update]\r\n\t");
            
            #line 456 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t@");
            
            #line 457 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 457 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.SqlTypeShort));
            
            #line default
            #line hidden
            
            #line 457 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 457 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 458 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("AS\r\n\tSET NOCOUNT ON\r\n\tUPDATE [");
            
            #line 461 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 461 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("] SET\r\n\t\t");
            
            #line 462 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t\t[");
            
            #line 463 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] = @");
            
            #line 463 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            
            #line 463 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 463 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 464 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\tWHERE ");
            
            #line 465 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(" = @");
            
            #line 465 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(" AND\r\n\t( 1=0");
            
            #line 466 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.FieldsExceptKey){ if(!field.SqlTypeShort.Equals("NTEXT")) { 
            
            #line default
            #line hidden
            this.Write(" OR [");
            
            #line 466 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] <> @");
            
            #line 466 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write(" OR ([");
            
            #line 466 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] IS NULL AND NOT @");
            
            #line 466 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write(" IS NULL) OR (NOT [");
            
            #line 466 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] IS NULL AND @");
            
            #line 466 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write(" IS NULL) ");
            
            #line 466 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}}
            
            #line default
            #line hidden
            this.Write(" )\r\n\tDELETE FROM [admin].[DeletedObjects] WHERE [Id] = @");
            
            #line 467 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("\r\nGO\r\n\r\nCREATE PROCEDURE [");
            
            #line 470 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 470 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_adm_markdelete]\r\n\t");
            
            #line 471 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t@");
            
            #line 472 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 472 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.SqlTypeShort));
            
            #line default
            #line hidden
            
            #line 472 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 472 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 473 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("AS\r\n\tSET NOCOUNT ON\r\n\tIF EXISTS(SELECT * FROM [");
            
            #line 476 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 476 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("] WHERE ");
            
            #line 476 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(" = @");
            
            #line 476 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(")\r\n\tUPDATE [");
            
            #line 477 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 477 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("] SET\r\n\t\t");
            
            #line 478 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t\t[");
            
            #line 479 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] = @");
            
            #line 479 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            
            #line 479 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 479 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 480 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\tWHERE ");
            
            #line 481 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(" = @");
            
            #line 481 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("\r\n\tELSE\r\n\tINSERT INTO [");
            
            #line 483 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 483 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("]\r\n\t(\r\n\t\t");
            
            #line 485 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t\t[");
            
            #line 486 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 486 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 486 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 487 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t)\r\n\tVALUES\r\n\t(\r\n\t\t");
            
            #line 491 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t\t@");
            
            #line 492 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            
            #line 492 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 492 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 493 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t)\r\n\tIF NOT EXISTS(SELECT * FROM [admin].[DeletedObjects] WHERE [Id] = @");
            
            #line 495 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(")\r\n\t\tINSERT INTO [admin].[DeletedObjects]([Id],[Entity],[CreationDate]) VALUES (@" +
                    "");
            
            #line 496 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(",\'");
            
            #line 496 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 496 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("\',GETDATE())\r\nGO\r\n\r\nCREATE PROCEDURE [");
            
            #line 499 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 499 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_adm_delete] @");
            
            #line 499 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(" UNIQUEIDENTIFIER AS\r\n\tSET NOCOUNT ON\r\n--\tDELETE FROM [");
            
            #line 501 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 501 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("] WHERE ");
            
            #line 501 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(" = @");
            
            #line 501 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("\r\n\tUPDATE [");
            
            #line 502 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 502 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_tracking] SET\r\n\t\t[sync_row_is_tombstone] = 1, \r\n\t\t[local_update_peer_key] = 0, \r" +
                    "\n\t\t[update_scope_local_id] = NULL, \r\n\t\t[last_change_datetime] = GETDATE() \r\n\tWHE" +
                    "RE ");
            
            #line 507 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(" = @");
            
            #line 507 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("\r\n\tUPDATE [admin].[DeletedObjects] SET [DeletionDate] = GETDATE() WHERE [Id] = @");
            
            #line 508 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("\r\nGO\r\n\r\nCREATE PROCEDURE [");
            
            #line 511 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 511 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_adm_exists] @");
            
            #line 511 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(" UNIQUEIDENTIFIER AS\r\n\tSET NOCOUNT ON\r\n\tSELECT ");
            
            #line 513 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(" FROM [");
            
            #line 513 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 513 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("] WHERE ");
            
            #line 513 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write(" = @");
            
            #line 513 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("\r\nGO\r\n\r\nCREATE PROCEDURE [");
            
            #line 516 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 516 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_adm_getnotexisting] @Xml XML AS\r\n\tSET NOCOUNT ON\r\n\tSELECT \r\n\t1 AS Tag, \r\n\tNULL A" +
                    "S Parent,\r\n\t\'");
            
            #line 521 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 521 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("\' AS [Entity!1!Name],\r\n\tNULL AS [Row!2!Id]\r\n\tUNION ALL\r\n\tSELECT \r\n\t\t2 AS Tag, \r\n\t" +
                    "\t1 AS Parent,\r\n\t\tNULL AS [Entity!1Name],\r\n\t\tT1.c.value(\'@Id\',\'UNIQUEIDENTIFIER\')" +
                    " AS [Row!2!Id]\r\n\tFROM @Xml.nodes(\'//Row\') T1(c)\r\n\tLEFT JOIN [");
            
            #line 530 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 530 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("] T2 ON T2.Id = T1.c.value(\'@Id\',\'UNIQUEIDENTIFIER\')\r\n\tWHERE T2.Id IS NULL\r\n\tORDE" +
                    "R BY 2,1\r\n\tFOR XML EXPLICIT\r\nGO\r\n\r\n");
            
            #line 536 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var tabularSection in entity.TabularSections){ 
            
            #line default
            #line hidden
            this.Write("\r\nCREATE PROCEDURE [");
            
            #line 538 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 538 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 538 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("_adm_insert]\r\n\t");
            
            #line 539 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("\t@");
            
            #line 540 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 540 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.SqlTypeShort));
            
            #line default
            #line hidden
            
            #line 540 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!tabularSection.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 540 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 541 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("AS\r\n\tSET NOCOUNT ON\r\n\tINSERT INTO [");
            
            #line 544 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 544 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 544 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("](\r\n\t\t");
            
            #line 545 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("[");
            
            #line 545 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 545 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!tabularSection.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 545 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            
            #line 545 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t) \r\n\tVALUES\r\n\t(\r\n\t\t");
            
            #line 549 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("@");
            
            #line 549 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            
            #line 549 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!tabularSection.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 549 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            
            #line 549 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t)\r\nGO\r\n\r\nCREATE PROCEDURE [");
            
            #line 553 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 553 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 553 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("_adm_insert_batch] @Ref UNIQUEIDENTIFIER, @Data [");
            
            #line 553 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[T_");
            
            #line 553 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 553 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] READONLY\r\nAS\r\n\tSET NOCOUNT ON\r\n\tINSERT INTO [");
            
            #line 556 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 556 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 556 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("](\r\n\t\t[Ref]");
            
            #line 557 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularFieldsExceptRefAndKey){ 
            
            #line default
            #line hidden
            this.Write(",[");
            
            #line 557 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 557 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t)\r\n\tSELECT \r\n\t\t@Ref\r\n\t\t");
            
            #line 561 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularFieldsExceptRefAndKey){ 
            
            #line default
            #line hidden
            this.Write(",[");
            
            #line 561 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 561 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\tFROM @Data\r\nGO\r\n\r\nCREATE PROCEDURE [");
            
            #line 565 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 565 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 565 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("_adm_clear] @Ref UNIQUEIDENTIFIER AS\r\n\tSET NOCOUNT ON\r\n\tDELETE FROM [");
            
            #line 567 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 567 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 567 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] WHERE [Ref] = @Ref\r\nGO\r\n\r\n");
            
            #line 570 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(tabularSection.HasTabularSectionKey){ 
            
            #line default
            #line hidden
            this.Write("\r\nCREATE PROCEDURE [");
            
            #line 572 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 572 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 572 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("_adm_selectkeys] @Ref UNIQUEIDENTIFIER AS\r\n\tSELECT ");
            
            #line 573 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("[");
            
            #line 573 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 573 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!tabularSection.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 573 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            
            #line 573 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\tFROM [");
            
            #line 574 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 574 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 574 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] WHERE [Ref] = @Ref\r\nGO\r\n\r\nCREATE PROCEDURE [");
            
            #line 577 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 577 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 577 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("_adm_update]\r\n\t");
            
            #line 578 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("\t@");
            
            #line 579 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 579 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.SqlTypeShort));
            
            #line default
            #line hidden
            
            #line 579 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!tabularSection.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 579 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 580 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("AS\r\n\tSET NOCOUNT ON\r\n\tIF EXISTS(SELECT * FROM [");
            
            #line 583 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 583 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 583 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] WHERE [Ref] = @Ref");
            
            #line 583 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularSectionKeys){ 
            
            #line default
            #line hidden
            this.Write(" AND ([");
            
            #line 583 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] = @");
            
            #line 583 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write(" OR ([");
            
            #line 583 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] IS NULL AND @");
            
            #line 583 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write(" IS NULL))");
            
            #line 583 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write(")\r\n\tUPDATE [");
            
            #line 584 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 584 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 584 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] SET\r\n\t\t");
            
            #line 585 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("\t\t[");
            
            #line 586 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] = @");
            
            #line 586 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            
            #line 586 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!tabularSection.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 586 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 587 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\tWHERE [Ref] = @Ref");
            
            #line 588 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularSectionKeys){ 
            
            #line default
            #line hidden
            this.Write(" AND [");
            
            #line 588 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] = @");
            
            #line 588 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            
            #line 588 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write(" AND \r\n\t( 1=0");
            
            #line 589 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularFieldsExceptKeys){ if(!field.SqlTypeShort.Equals("NTEXT")) { 
            
            #line default
            #line hidden
            this.Write(" OR [");
            
            #line 589 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] <> @");
            
            #line 589 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            
            #line 589 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}}
            
            #line default
            #line hidden
            this.Write(" )\r\n\tELSE\r\n\tINSERT INTO [");
            
            #line 591 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 591 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 591 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("](\r\n\t\t");
            
            #line 592 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("[");
            
            #line 592 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 592 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!tabularSection.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 592 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            
            #line 592 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t) \r\n\tVALUES\r\n\t(\r\n\t\t");
            
            #line 596 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("@");
            
            #line 596 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            
            #line 596 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!tabularSection.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 596 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            
            #line 596 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t)\r\nGO\r\n\r\nCREATE PROCEDURE [");
            
            #line 600 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 600 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 600 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("_adm_update_batch_all] @Ref UNIQUEIDENTIFIER, @Data [");
            
            #line 600 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[T_");
            
            #line 600 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 600 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] READONLY\r\nAS\r\n\tSET NOCOUNT ON\r\n\tUPDATE [");
            
            #line 603 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 603 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 603 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] SET\r\n\t\t");
            
            #line 604 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularFieldsExceptRefAndKey){ 
            
            #line default
            #line hidden
            this.Write("\t\t[");
            
            #line 605 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] = D.[");
            
            #line 605 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 605 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!tabularSection.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 605 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 606 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\tFROM [");
            
            #line 607 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 607 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 607 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] T\r\n\tJOIN @Data D ON T.Ref = @Ref");
            
            #line 608 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularSectionKeys){ 
            
            #line default
            #line hidden
            this.Write(" AND (T.[");
            
            #line 608 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] = D.[");
            
            #line 608 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] OR (T.[");
            
            #line 608 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] IS NULL AND D.[");
            
            #line 608 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] IS NULL))");
            
            #line 608 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\tWHERE T.Ref = @Ref AND\r\n\t( 1=0");
            
            #line 610 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularFieldsExceptRefAndKey){ if(!field.SqlTypeShort.Equals("NTEXT")) { 
            
            #line default
            #line hidden
            this.Write(" OR T.[");
            
            #line 610 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] <> D.[");
            
            #line 610 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 610 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}}
            
            #line default
            #line hidden
            this.Write(" )\r\n\r\n\tINSERT INTO [");
            
            #line 612 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 612 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 612 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("](\r\n\t\t[Ref]");
            
            #line 613 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularFieldsExceptRefAndKey){ 
            
            #line default
            #line hidden
            this.Write(",[");
            
            #line 613 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 613 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t)\r\n\tSELECT \r\n\t\t@Ref\r\n\t\t");
            
            #line 617 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularFieldsExceptRefAndKey){ 
            
            #line default
            #line hidden
            this.Write(",D.[");
            
            #line 617 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 617 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\tFROM @Data D\r\n\t\tLEFT JOIN [");
            
            #line 619 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 619 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 619 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] T ON T.Ref = @Ref");
            
            #line 619 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularSectionKeys){ 
            
            #line default
            #line hidden
            this.Write(" AND (T.[");
            
            #line 619 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] = D.[");
            
            #line 619 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] OR (T.[");
            
            #line 619 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] IS NULL AND D.[");
            
            #line 619 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] IS NULL))");
            
            #line 619 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\tWHERE T.[");
            
            #line 620 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.KeyField));
            
            #line default
            #line hidden
            this.Write("] IS NULL\r\n\r\n\tDELETE FROM [");
            
            #line 622 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 622 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 622 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("]\r\n\tFROM [");
            
            #line 623 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 623 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 623 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] T\r\n\tLEFT JOIN @Data D ON T.Ref = @Ref");
            
            #line 624 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularSectionKeys){ 
            
            #line default
            #line hidden
            this.Write(" AND (T.[");
            
            #line 624 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] = D.[");
            
            #line 624 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] OR (T.[");
            
            #line 624 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] IS NULL AND D.[");
            
            #line 624 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] IS NULL))");
            
            #line 624 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\tWHERE T.Ref = @Ref");
            
            #line 625 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularSectionKeys){ 
            
            #line default
            #line hidden
            this.Write(" AND D.[");
            
            #line 625 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] IS NULL");
            
            #line 625 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t \r\nGO\r\n\r\nCREATE PROCEDURE [");
            
            #line 629 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 629 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 629 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("_adm_delete] @Ref UNIQUEIDENTIFIER\r\n\t");
            
            #line 630 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularSectionKeys){ 
            
            #line default
            #line hidden
            this.Write("\t,@");
            
            #line 631 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 631 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.SqlTypeShort));
            
            #line default
            #line hidden
            this.Write("\r\n\t");
            
            #line 632 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("AS\r\n\tSET NOCOUNT ON\r\n\tDELETE FROM [");
            
            #line 635 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 635 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 635 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("]\r\n\tWHERE [Ref] = @Ref");
            
            #line 636 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in tabularSection.TabularSectionKeys){ 
            
            #line default
            #line hidden
            this.Write(" AND [");
            
            #line 636 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] = @");
            
            #line 636 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            
            #line 636 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\r\nGO\r\n\r\n");
            
            #line 639 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\r\n");
            
            #line 641 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\r\n");
            
            #line 643 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\r\n---------------------------------------------------------SYNC GETCHANGES ------" +
                    "----------------------------------------------------\r\nGO\r\n\r\n");
            
            #line 648 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 int n = 0; 
            
            #line default
            #line hidden
            
            #line 649 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var entity in config.Entities){ 
            
            #line default
            #line hidden
            this.Write("\r\nCREATE PROCEDURE [");
            
            #line 651 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 651 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write(@"_adm_getchanges] @SessionId UNIQUEIDENTIFIER AS
	SET NOCOUNT ON
	DECLARE @DateFrom DATETIME, @DateTo DATETIME
	SELECT @DateFrom = LastTime FROM [admin].LastSyncTime
	SELECT @DateTo = StartTime FROM [admin].SyncSession WHERE [Id] = @SessionId
	IF @DateFrom IS NULL OR @DateTo IS NULL
	  RAISERROR('Invalid interval', 16, 1)

	DECLARE @Ids TABLE(Id UNIQUEIDENTIFIER)
	INSERT @Ids 
	SELECT E.[");
            
            #line 661 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("] \r\n\tFROM [");
            
            #line 662 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 662 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("] E\r\n\tJOIN [");
            
            #line 663 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 663 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_tracking] T ON T.[");
            
            #line 663 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("] = E.[");
            
            #line 663 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("]\r\n\tWHERE T.[last_change_datetime] BETWEEN @DateFrom AND @DateTo AND (NOT T.updat" +
                    "e_scope_local_id IS NULL/* OR NOT T.create_scope_local_id IS NULL*/)\r\n\t");
            
            #line 665 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var tabularSection in entity.TabularSections){ 
            
            #line default
            #line hidden
            this.Write("\tUNION\r\n\tSELECT E.Ref \r\n\tFROM [");
            
            #line 668 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 668 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 668 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] E\r\n\tJOIN [");
            
            #line 669 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 669 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 669 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("_tracking] T ON T.[");
            
            #line 669 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.KeyField));
            
            #line default
            #line hidden
            this.Write("] = E.[");
            
            #line 669 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.KeyField));
            
            #line default
            #line hidden
            this.Write("]\r\n\tWHERE T.[last_change_datetime] BETWEEN @DateFrom AND @DateTo AND (NOT T.updat" +
                    "e_scope_local_id IS NULL/* OR NOT T.create_scope_local_id IS NULL*/)\t\r\n\t");
            
            #line 671 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\r\n\tSELECT\r\n\t1 AS Tag, NULL AS Parent,\r\n\t\'");
            
            #line 675 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 675 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("\' AS [Entity!1!Name],\r\n\tNULL AS [Row!2!");
            
            #line 676 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("],\r\n\t");
            
            #line 677 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("NULL AS [Row!2!");
            
            #line 677 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 677 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 677 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            
            #line 677 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 678 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 n = 0; 
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 679 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var ts in entity.TabularSections){ 
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 680 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 n++; 
            
            #line default
            #line hidden
            this.Write("\t\t,NULL AS [");
            
            #line 681 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ts.Name));
            
            #line default
            #line hidden
            this.Write("!");
            
            #line 681 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("1]\r\n\t\t");
            
            #line 682 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 683 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 n = 0; 
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 684 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var ts in entity.TabularSections){ 
            
            #line default
            #line hidden
            this.Write("\t\t\t");
            
            #line 685 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 n++; 
            
            #line default
            #line hidden
            this.Write("\t\t\t");
            
            #line 686 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var fld in ts.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t\t\t,NULL AS [Row!");
            
            #line 687 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("2!");
            
            #line 687 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fld.Name));
            
            #line default
            #line hidden
            this.Write("]\r\n\t\t");
            
            #line 688 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 689 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\r\n\tUNION ALL\r\n\r\n\tSELECT\r\n\t2 AS Tag, 1 AS Parent,\r\n\tNULL AS [Entity!1!Name],\r\n\tH.[" +
                    "");
            
            #line 696 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("] AS [Row!2!");
            
            #line 696 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("],\r\n\t");
            
            #line 697 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("H.[");
            
            #line 697 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("] AS [Row!2!");
            
            #line 697 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 697 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 697 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            
            #line 697 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 698 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 n = 0; 
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 699 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var ts in entity.TabularSections){ 
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 700 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 n++; 
            
            #line default
            #line hidden
            this.Write("\t\t,NULL AS [");
            
            #line 701 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ts.Name));
            
            #line default
            #line hidden
            this.Write("!");
            
            #line 701 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("1]\r\n\t\t");
            
            #line 702 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 703 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 n = 0; 
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 704 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var ts in entity.TabularSections){ 
            
            #line default
            #line hidden
            this.Write("\t\t\t");
            
            #line 705 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 n++; 
            
            #line default
            #line hidden
            this.Write("\t\t\t");
            
            #line 706 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var fld in ts.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t\t\t,NULL AS [Row!");
            
            #line 707 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("2!");
            
            #line 707 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fld.Name));
            
            #line default
            #line hidden
            this.Write("]\r\n\t\t");
            
            #line 708 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 709 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\tFROM [");
            
            #line 710 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 710 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("] H\r\n\tJOIN @Ids Ids ON Ids.Id = H.Id\r\n\r\n\t");
            
            #line 713 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 n = 0; 
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 714 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var tabularSection in entity.TabularSections){ 
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 715 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 n++; 
            
            #line default
            #line hidden
            this.Write("\r\n\tUNION ALL\r\n\r\n\tSELECT\r\n\t");
            
            #line 720 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("1 AS Tag, 2 AS Parent,\r\n\tNULL AS [Entity!1!Name],\r\n\tIds.Id AS [Row!2!");
            
            #line 722 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("],\r\n\t");
            
            #line 723 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("NULL AS [Row!2!");
            
            #line 723 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 723 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 723 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            
            #line 723 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 724 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var ts in entity.TabularSections){ 
            
            #line default
            #line hidden
            this.Write("\t\t,NULL AS [");
            
            #line 725 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ts.Name));
            
            #line default
            #line hidden
            this.Write("!");
            
            #line 725 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("1]\r\n\t\t");
            
            #line 726 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 727 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var ts in entity.TabularSections){ 
            
            #line default
            #line hidden
            this.Write("\t\t\t");
            
            #line 728 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var fld in ts.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t\t\t,NULL AS [Row!");
            
            #line 729 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("2!");
            
            #line 729 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fld.Name));
            
            #line default
            #line hidden
            this.Write("]\r\n\t\t");
            
            #line 730 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 731 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\tFROM @Ids Ids\r\n\r\n\tUNION ALL\r\n\r\n\tSELECT\r\n\t");
            
            #line 737 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("2 AS Tag, ");
            
            #line 737 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("1 AS Parent,\r\n\tNULL AS [Entity!1!Name],\r\n\tIds.Id AS [Row!2!");
            
            #line 739 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("],\r\n\t");
            
            #line 740 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var field in entity.FieldsExceptKey){ 
            
            #line default
            #line hidden
            this.Write("NULL AS [Row!2!");
            
            #line 740 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(field.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 740 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!entity.LastField(field.Name)){ 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 740 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            
            #line 740 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 741 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var ts in entity.TabularSections){ 
            
            #line default
            #line hidden
            this.Write("\t\t,NULL AS [");
            
            #line 742 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ts.Name));
            
            #line default
            #line hidden
            this.Write("!");
            
            #line 742 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("1]\r\n\t\t");
            
            #line 743 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 744 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var ts in entity.TabularSections){ 
            
            #line default
            #line hidden
            this.Write("\t\t\t");
            
            #line 745 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 foreach(var fld in ts.Fields){ 
            
            #line default
            #line hidden
            this.Write("\t\t\t");
            
            #line 746 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(ts.Equals(tabularSection)) {
            
            #line default
            #line hidden
            this.Write(" ,T.[");
            
            #line 746 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fld.Name));
            
            #line default
            #line hidden
            this.Write("] AS [Row!");
            
            #line 746 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("2!");
            
            #line 746 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fld.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 746 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t\t");
            
            #line 747 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 if(!ts.Equals(tabularSection)) {
            
            #line default
            #line hidden
            this.Write(" ,NULL AS [Row!");
            
            #line 747 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(n));
            
            #line default
            #line hidden
            this.Write("2!");
            
            #line 747 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(fld.Name));
            
            #line default
            #line hidden
            this.Write("]");
            
            #line 747 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t\t");
            
            #line 748 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\t");
            
            #line 749 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\tFROM @Ids Ids\r\n\tJOIN [");
            
            #line 751 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Schema));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 751 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("_");
            
            #line 751 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(tabularSection.Name));
            
            #line default
            #line hidden
            this.Write("] T ON T.Ref = Ids.Id\r\n\r\n\t");
            
            #line 753 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\r\n\tORDER BY [Row!2!");
            
            #line 755 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.KeyField));
            
            #line default
            #line hidden
            this.Write("], Tag ");
            
            #line 755 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
 for(int i=0; i<entity.TabularSections.Count;i++){ 
            
            #line default
            #line hidden
            this.Write(",[Row!");
            
            #line 755 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture((i+1).ToString()));
            
            #line default
            #line hidden
            this.Write("2!LineNumber]");
            
            #line 755 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            this.Write("\r\n\tFOR XML EXPLICIT\r\nGO\r\n\r\n");
            
            #line 760 "D:\Projects\core\BitMobileServer\Core\CodeFactory\CodeGeneration\Templates\Database\DatabaseAdmin.tt"
}
            
            #line default
            #line hidden
            return this.GenerationEnvironment.ToString();
        }
    }
    
    #line default
    #line hidden
    #region Base class
    /// <summary>
    /// Base class for this transformation
    /// </summary>
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "11.0.0.0")]
    public class DatabaseAdminBase
    {
        #region Fields
        private global::System.Text.StringBuilder generationEnvironmentField;
        private global::System.CodeDom.Compiler.CompilerErrorCollection errorsField;
        private global::System.Collections.Generic.List<int> indentLengthsField;
        private string currentIndentField = "";
        private bool endsWithNewline;
        private global::System.Collections.Generic.IDictionary<string, object> sessionField;
        #endregion
        #region Properties
        /// <summary>
        /// The string builder that generation-time code is using to assemble generated output
        /// </summary>
        protected System.Text.StringBuilder GenerationEnvironment
        {
            get
            {
                if ((this.generationEnvironmentField == null))
                {
                    this.generationEnvironmentField = new global::System.Text.StringBuilder();
                }
                return this.generationEnvironmentField;
            }
            set
            {
                this.generationEnvironmentField = value;
            }
        }
        /// <summary>
        /// The error collection for the generation process
        /// </summary>
        public System.CodeDom.Compiler.CompilerErrorCollection Errors
        {
            get
            {
                if ((this.errorsField == null))
                {
                    this.errorsField = new global::System.CodeDom.Compiler.CompilerErrorCollection();
                }
                return this.errorsField;
            }
        }
        /// <summary>
        /// A list of the lengths of each indent that was added with PushIndent
        /// </summary>
        private System.Collections.Generic.List<int> indentLengths
        {
            get
            {
                if ((this.indentLengthsField == null))
                {
                    this.indentLengthsField = new global::System.Collections.Generic.List<int>();
                }
                return this.indentLengthsField;
            }
        }
        /// <summary>
        /// Gets the current indent we use when adding lines to the output
        /// </summary>
        public string CurrentIndent
        {
            get
            {
                return this.currentIndentField;
            }
        }
        /// <summary>
        /// Current transformation session
        /// </summary>
        public virtual global::System.Collections.Generic.IDictionary<string, object> Session
        {
            get
            {
                return this.sessionField;
            }
            set
            {
                this.sessionField = value;
            }
        }
        #endregion
        #region Transform-time helpers
        /// <summary>
        /// Write text directly into the generated output
        /// </summary>
        public void Write(string textToAppend)
        {
            if (string.IsNullOrEmpty(textToAppend))
            {
                return;
            }
            // If we're starting off, or if the previous text ended with a newline,
            // we have to append the current indent first.
            if (((this.GenerationEnvironment.Length == 0) 
                        || this.endsWithNewline))
            {
                this.GenerationEnvironment.Append(this.currentIndentField);
                this.endsWithNewline = false;
            }
            // Check if the current text ends with a newline
            if (textToAppend.EndsWith(global::System.Environment.NewLine, global::System.StringComparison.CurrentCulture))
            {
                this.endsWithNewline = true;
            }
            // This is an optimization. If the current indent is "", then we don't have to do any
            // of the more complex stuff further down.
            if ((this.currentIndentField.Length == 0))
            {
                this.GenerationEnvironment.Append(textToAppend);
                return;
            }
            // Everywhere there is a newline in the text, add an indent after it
            textToAppend = textToAppend.Replace(global::System.Environment.NewLine, (global::System.Environment.NewLine + this.currentIndentField));
            // If the text ends with a newline, then we should strip off the indent added at the very end
            // because the appropriate indent will be added when the next time Write() is called
            if (this.endsWithNewline)
            {
                this.GenerationEnvironment.Append(textToAppend, 0, (textToAppend.Length - this.currentIndentField.Length));
            }
            else
            {
                this.GenerationEnvironment.Append(textToAppend);
            }
        }
        /// <summary>
        /// Write text directly into the generated output
        /// </summary>
        public void WriteLine(string textToAppend)
        {
            this.Write(textToAppend);
            this.GenerationEnvironment.AppendLine();
            this.endsWithNewline = true;
        }
        /// <summary>
        /// Write formatted text directly into the generated output
        /// </summary>
        public void Write(string format, params object[] args)
        {
            this.Write(string.Format(global::System.Globalization.CultureInfo.CurrentCulture, format, args));
        }
        /// <summary>
        /// Write formatted text directly into the generated output
        /// </summary>
        public void WriteLine(string format, params object[] args)
        {
            this.WriteLine(string.Format(global::System.Globalization.CultureInfo.CurrentCulture, format, args));
        }
        /// <summary>
        /// Raise an error
        /// </summary>
        public void Error(string message)
        {
            System.CodeDom.Compiler.CompilerError error = new global::System.CodeDom.Compiler.CompilerError();
            error.ErrorText = message;
            this.Errors.Add(error);
        }
        /// <summary>
        /// Raise a warning
        /// </summary>
        public void Warning(string message)
        {
            System.CodeDom.Compiler.CompilerError error = new global::System.CodeDom.Compiler.CompilerError();
            error.ErrorText = message;
            error.IsWarning = true;
            this.Errors.Add(error);
        }
        /// <summary>
        /// Increase the indent
        /// </summary>
        public void PushIndent(string indent)
        {
            if ((indent == null))
            {
                throw new global::System.ArgumentNullException("indent");
            }
            this.currentIndentField = (this.currentIndentField + indent);
            this.indentLengths.Add(indent.Length);
        }
        /// <summary>
        /// Remove the last indent that was added with PushIndent
        /// </summary>
        public string PopIndent()
        {
            string returnValue = "";
            if ((this.indentLengths.Count > 0))
            {
                int indentLength = this.indentLengths[(this.indentLengths.Count - 1)];
                this.indentLengths.RemoveAt((this.indentLengths.Count - 1));
                if ((indentLength > 0))
                {
                    returnValue = this.currentIndentField.Substring((this.currentIndentField.Length - indentLength));
                    this.currentIndentField = this.currentIndentField.Remove((this.currentIndentField.Length - indentLength));
                }
            }
            return returnValue;
        }
        /// <summary>
        /// Remove any indentation
        /// </summary>
        public void ClearIndent()
        {
            this.indentLengths.Clear();
            this.currentIndentField = "";
        }
        #endregion
        #region ToString Helpers
        /// <summary>
        /// Utility class to produce culture-oriented representation of an object as a string.
        /// </summary>
        public class ToStringInstanceHelper
        {
            private System.IFormatProvider formatProviderField  = global::System.Globalization.CultureInfo.InvariantCulture;
            /// <summary>
            /// Gets or sets format provider to be used by ToStringWithCulture method.
            /// </summary>
            public System.IFormatProvider FormatProvider
            {
                get
                {
                    return this.formatProviderField ;
                }
                set
                {
                    if ((value != null))
                    {
                        this.formatProviderField  = value;
                    }
                }
            }
            /// <summary>
            /// This is called from the compile/run appdomain to convert objects within an expression block to a string
            /// </summary>
            public string ToStringWithCulture(object objectToConvert)
            {
                if ((objectToConvert == null))
                {
                    throw new global::System.ArgumentNullException("objectToConvert");
                }
                System.Type t = objectToConvert.GetType();
                System.Reflection.MethodInfo method = t.GetMethod("ToString", new System.Type[] {
                            typeof(System.IFormatProvider)});
                if ((method == null))
                {
                    return objectToConvert.ToString();
                }
                else
                {
                    return ((string)(method.Invoke(objectToConvert, new object[] {
                                this.formatProviderField })));
                }
            }
        }
        private ToStringInstanceHelper toStringHelperField = new ToStringInstanceHelper();
        /// <summary>
        /// Helper to produce culture-oriented representation of an object as a string
        /// </summary>
        public ToStringInstanceHelper ToStringHelper
        {
            get
            {
                return this.toStringHelperField;
            }
        }
        #endregion
    }
    #endregion
}
